<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Práctica de plataformas de publicación y distribución - Carlos Manuel Ruiz Ruiz</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Práctica de plataformas de publicación y distribución</h1>
        <h2 class="nombre">Carlos Manuel Ruiz Ruiz</h2>
    </header>
    <main>
        <section>
            <h2>Ejercicio 1: Clip de vídeo incrustado en HTML 5</h2>

            <h3>Tarea 1.1</h3>
            <p>He elegido un clip de vídeo de 19 segundos grabado con mi dispositivo móvil que incluye tanto un detalle de mi carnet de estudiante como una serie de vehículos y personas en movimiento.</p>
            <h4>Formato</h4>
            <p>Para su publicación en la web con HTML5 he decidido codificarlo en los siguientes formatos:</p>
            <ul>
                <li><strong>MP4 (H.264 + AAC):</strong> Es el formato de vídeo más ampliamente soportado por navegadores y dispositivos. Proporciona una excelente calidad de compresión con un tamaño de archivo relativamente pequeño [1].</li>
                <li><strong>WebM (VP9 + Vorbis):</strong> Es un formato abierto soportado por la mayoría de los navegadores modernos incluidos Chrome, Firefox y Opera. Ofrece buena calidad y compresión y es una excelente alternativa a MP4 para garantizar la compatibilidad con navegadores que prefieren formatos abiertos [2].</li>
            </ul>
            <p>Esta elección debería cubrir prácticamente todos los navegadores modernos ofreciendo una buena relación entre calidad y tamaño de archivo lo que es crucial para una experiencia de visualización fluida sin consumir demasiado ancho de banda.</p>
            <h4>Resolución y Fotogramas por Segundo (FPS)</h4>
            <p>Para asegurar una buena experiencia de usuario y optimizar el uso de recursos he codificado el vídeo en dos resoluciones:</p>
            <ul>
                <li><strong>HD (1280x720):</strong> Proporciona una excelente calidad de imagen adecuada para la mayoría de dispositivos. Es soportada por todos los navegadores y conexiones modernas, ofreciendo un buen equilibrio entre calidad y tamaño del archivo.</li>
                <li><strong>360p (640x360):</strong> Produce archivos de menor tamaño, ideal para usuarios con limitaciones de datos o conexiones lentas. Adecuada para dispositivos antiguos, garantiza una reproducción fluida en condiciones de red más limitadas.</li>
            </ul>
            <p>Esta selección proporciona una experiencia de visualización de alta calidad para usuarios con conexiones y dispositivos modernos mientras se mantiene la accesibilidad y la eficiencia para aquellos con limitaciones en sus recursos tecnológicos.</p>
            <p>En todos los casos una tasa estándar de 30 FPS que asegura una reproducción fluida y es adecuada para el contenido de vídeo en línea.</p>
            <h4>Tasa de bits y confirmación con la herramienta MediaInfo</h4>
            <p>Según El IBM Streaming Support Center se recomienda una tasa de bits de video de entre 1200 y 4000 kbps para la resolución 1280x720 y de entre 800 y 1200 kbps para 640x360 [3]. Por tanto utilizo:</p>
            <ul>
                <li>3000 kbps para los videos con resolución 1280x720 y 30fps</li>
                <li>1000 kbps para los videos con resolución 640x360 y 30fps</li>
                <li>128 kbps para los canales de audio</li>
            </ul>
            <p>Compruebo con MediaInfo que el bitrate total de los cuatro videos generados. Es correcto una vez considerado el bitrate de los canales de audio:</p>
            <ul>
                <li>VID_PR_H264_720p.mp4 (H.264 + AAC con resolución 1280x720 y 30fps): 3137kbps</li>
                <li>VID_PR_H264_360p.mp4 (H.264 + AAC con resolución 640x360 y 30fps): 1136 kbps</li>
                <li>VID_PR_VP9_720p.webm (VP9 + Vorbis con resolución 1280x720 y 30fps): 3097 kbps</li>
                <li>VID_PR_VP9_360p.webm (VP9 + Vorbis con resolución 640x360 y 30fps): 1102 kbps</li>
            </ul>
            <video controls width="854" height="480" preload="auto" defaultPlaybackRate="1.0" volume="0.8" disablepictureinpicture>
                <source src="videos/VID_PR_H264_720p.mp4" type="video/mp4">
                <source src="videos/VID_PR_H264_360p.mp4" type="video/mp4">
                <source src="videos/VID_PR_VP9_720p.webm" type="video/webm">
                <source src="videos/VID_PR_VP9_360p.webm" type="video/webm">
                Tu navegador no soporta el elemento de vídeo.
            </video>
			
            <h3>Tarea 1.2</h3>
            <h4>Creación de la Web:</h4>
            <p>He generado un fichero .html mediante un editor de texto que incluye el siguiente código:</p>
            <img src="images/Imagen1.png" alt="Código de la web con el clip de video incrustado en sus diferentes opciones">
            <p>Tal y como indica el enunciado he utilizado la etiqueta &lt;video&gt; para incrustar el vídeo. Con el atributo ‘controls’ se añaden los controles de reproducción como play, pause y volumen.</p>
            <p>Para asegurar que la web pueda ser visualizada desde la mayor parte de los navegadores he utilizado el elemento <source> para añadir las distintas fuentes de video con los formatos que se codificaron en la tarea anterior. El navegador elegirá automáticamente el formato más adecuado que pueda reproducir. Por último he incluido un mensaje alternativo que se mostrará en el caso de que no se pueda reproducir el elemento de video.</p>
            <h4>Características del Formato HTML5:</h4>
            <p>El formato HTML5 se distingue por varias características que lo hacen ideal para la publicación y visualización de vídeos en la web comparado con métodos más antiguos [4] [5]:</p>
            <ul>
                <li><strong>Soporte Multiplataforma:</strong> Compatible con una amplia gama de dispositivos incluyendo ordenadores de escritorio, portátiles, tablets y smartphones.</li>
                <li><strong>Compatibilidad Nativa:</strong> Funciona en todos los navegadores modernos sin necesidad de plugins adicionales.</li>
                <li><strong>Uso de Etiquetas Semánticas:</strong> La etiqueta &lt;video&gt; es semántica y fácil de usar permitiendo la incrustación de vídeos con pocas líneas de código.</li>
                <li><strong>Carga Adaptativa:</strong> Permite especificar múltiples fuentes de vídeo para asegurar la compatibilidad máxima y elegir automáticamente la mejor opción disponible.</li>
                <li><strong>Accesibilidad:</strong> Soporta subtítulos y descripciones de audio mediante la etiqueta &lt;track&gt; mejorando la accesibilidad para usuarios con discapacidades.</li>
                <li><strong>Navegación sin conexión:</strong> Permite a los usuarios continuar navegando por las páginas web y aplicaciones web incluso sin conexión.</li>
                <li><strong>Integración con CSS y JavaScript:</strong> Facilita la personalización y manipulación de la reproducción del vídeo permitiendo crear experiencias de usuario interactivas y estilizadas.</li>
            </ul>

            <h3>Tarea 1.3</h3>
            <h4>Publicación de la web.</h4>
            <p>He publicado el fichero .html y los vídeos en GitHub [6], una plataforma que permite hacerlo de manera gratuita a través de GitHub Pages.</p>
            <p>Para ello he creado un nuevo repositorio en el que he subido el archivo html5 ‘index.html’ y los videos que he generado en las tareas anteriores. Por último publico la rama en GitHub Pages:</p>
            <img src="images/Imagen2.png" alt="Publicación del sitio en GitHub Pages">
            <h4>Experiencia de usuario</h4>
            <p>La experiencia al visualizar el video es buena, se reproduce casi inmediatamente, no se producen cortes y la calidad es muy buena. El único inconveniente lo he encontrado a la hora de reproducirlo a través de mi dispositivo móvil. El tamaño del video no se escala en función de la ventana en que se reproduce y a la hora de verlo desde el teléfono el tamaño de reproducción es muy grande, he tenido que alejar la imagen para verlo completo. Con los controles incrustados también es posible reproducirlo a pantalla completa.</p>

            <h3>Tarea 1.4</h3>
            <p>En el transcurso de esta tarea he experimentado con las distintas funcionalidades que es posible añadir al vídeo utilizando los atributos que el tag &lt;video&gt; ofrece en HTML5. A continuación detallo las que he añadido y cómo creo que mejoran la experiencia del usuario:</p>
            <ul>
                <li><strong>Controls:</strong> Ya los tenía en la versión inicial de la web. Los controles de reproducción permiten al usuario pausar, reproducir y ajustar el volumen del vídeo.</li>
                <li><strong>Width y height:</strong> He reestablecido las dimensiones del vídeo a 854x480 píxeles, un tamaño adecuado para la mayoría de las pantallas.</li>
                <li><strong>Poster:</strong> He añadido una imagen de póster (poster.jpg) que se muestra antes de que el vídeo comience a reproducirse, proporcionando una vista previa más atractiva.</li>
                <li><strong>ControlsList:</strong> La opción nodownload oculta el botón de descarga. Esto no supone tanto una mejora de la experiencia de usuario, sino del administrador de la web al que permite mantener cierto control sobre el contenido.</li>
                <li><strong>Preload:</strong> Configurado en auto permite que el vídeo se cargue completamente al cargar la página, lo que asegura una reproducción sin interrupciones.</li>
                <li><strong>DefaultPlaybackRate:</strong> Establecida en 1.0, que es la velocidad de reproducción normal del vídeo.</li>
                <li><strong>DisablePictureInPicture:</strong> Deshabilita la función de Picture-in-Picture manteniendo la reproducción dentro de la página.</li>
                <li><strong>Volume:</strong> Inicialmente ajustado al 80% del volumen máximo para un nivel de audio cómodo.</li>
                <li><strong>Subtítulos:</strong> He añadido pistas de subtítulos en español (captions.es.vtt) e inglés (captions.en.vtt) para mejorar la accesibilidad del contenido.</li>
            </ul>
            <img src="images/Imagen3.png" alt="Código de la web con el clip de video incrustado y con atributos añadidos">
            <p>La web está disponible a través del siguiente enlace:</p>
            <a href="https://carlosmdobler.github.io/html5-video/">https://carlosmdobler.github.io/html5-video/</a>

            <h3>Tarea 1.5</h3>
            <p>Los CDN han evolucionado más allá de su función básica de distribución de contenido, ofreciendo una gran variedad de servicios que aportan valor añadido y que mejoran la publicación y distribución de material multimedia. A continuación detallo algunos de los que los pueden ofrecer:</p>
            <ul>
                <li><strong>Subtitulado automático:</strong> Transcripción y generación automática de subtítulos para vídeos, mejorando la accesibilidad y la indexación del contenido. AWS lo ofrece a través de Amazon Transcribe [7].</li>
                <li><strong>Identificación de cambios de plano:</strong> Detección y marcaje automático de los cambios de plano en los vídeos, puede ser útil para la edición de vídeo y la creación de resúmenes automáticos. AWS lo ofrece a través de AWS Rekognition Video [8].</li>
                <li><strong>Detección de caras:</strong> Identificación y seguimiento de caras en vídeos, lo que puede ser utilizado para la creación de metadatos, análisis de audiencias y mejoras en la búsqueda. También se ofrece a través de Rekognition en AWS.</li>
                <li><strong>Análisis de sentimiento y contenido:</strong> Análisis del contenido de vídeo para determinar el tono emocional, los temas principales y otros aspectos contextuales. Disponible a través de a través de AWS Rekognition Video.</li>
                <li><strong>Optimización de calidad adaptativa (ABR):</strong> Ajuste dinámico de la calidad del vídeo en función del ancho de banda y las capacidades del dispositivo del usuario para asegurar una reproducción continua y sin interrupciones. AWS Elemental MediaPackage [9] proporciona ABR para la entrega de vídeo en múltiples calidades basadas en las condiciones de red.</li>
                <li><strong>Protección de contenido:</strong> Inserción de marcas de agua digitales y técnicas de protección de contenido para prevenir la piratería y el uso no autorizado. Está disponible a través de AWS Elemental MediaPackage [9].</li>
                <li><strong>Traducción:</strong> Traducción automática de audio y subtítulos en tiempo real para una audiencia global. Amazon Transcribe puede convertir el audio a texto en tiempo real y Amazon Translate puede traducir ese texto a otros idiomas en tiempo real [10].</li>
            </ul>
        </section>

        <section>
            <h2>Ejercicio 2: Práctica de streaming de un vídeo local</h2>

            <h3>Tarea 2.1</h3>
            <p>He utilizado un fragmento de un documental para generar un clip de vídeo de 19 segundos con movimiento. Al hacerlo convertí el clip a formato MP4 utilizando Avidemux con los siguientes valores:</p>
            <ul>
                <li>Codificación de salida: MPEG4 AVC</li>
                <li>Modo de codificación: Tasa de bits media - dos pasadas a 5000 Kbps</li>
                <li>Formato de audio: MP3 (lame)</li>
                <li>Contenedor: MKV</li>
            </ul>
            <p>Por último he verificado con MediaInfo que la conversión se ha realizado correctamente.</p>
            <img src="images/Imagen4.png" alt="Información básica del clip01 en MediaInfo">
            <video controls width="854" height="480" preload="auto" defaultPlaybackRate="1.0" volume="0.8" disablepictureinpicture>
		<source src="videos/clip01.mkv" type="video/mp4">
		<source src="videos/clip01.mkv" type="video/x-matroska">
                Tu navegador no soporta el elemento de vídeo.
            </video>
            <h3>Tarea 2.2</h3>
            <p>He configurado la emisión repetitiva del clip01 siguiendo el ejemplo del clip de fútbol. Como el stream se entrecortaba he decidido utilizar el códec de emisión H.264+MP3 (TS) tal y como se recomienda en el enunciado para estas situaciones.</p>
            <img src="images/Imagen5.png" alt="Stream del clip01">
            <p>De acuerdo con la información del códec obtenida en el VLC de emisión el fichero almacenado se generó con codificación de video H264 AVC y con codificación de audio MPEG audio layer 1/2.</p>
            <img src="images/Imagen6.png" alt="Codificación del archivo almacenado según VLC">
            <p>Revisando las estadísticas de emisión he podido comprobar que la tasa de bits de contenido varía entre los 2500kb/s y los 9000kb/s con una media de unos 4000kb/s</p>
            <img src="images/Imagen7.png" alt="Estadísticas de emisión">

            <h3>Tarea 2.3</h3>
            <p>Revisando ahora la información del códec en el VLC de recepción he podido comprobar que el stream recibido tiene una codificación de video H264 AVC y de audio MPEG audio layer 1/2 que coincide con la que se seleccionó para la emisión.</p>
            <img src="images/Imagen8.png" alt="Codificación del stream recibido según VLC">
            <p>La tasa de bits de entrada sin embargo es de en torno a los 1500kb/s. Muy por debajo de la de emisión. Esto afecta a la calidad del vídeo resultando en una imagen menos nítida y con algunos artefactos de compresión.</p>
            <img src="images/Imagen9.png" alt="Estadísticas de recepción">

            <h3>Tarea 2.4</h3>
            <p>Si pauso el emisor el receptor tarda aproximadamente 1 segundo en pausarse. Esto ocurre porque el receptor tiene un caché que almacena hasta 1000 ms de datos del stream para asegurar una reproducción continua y sin interrupciones.</p>
            <img src="images/Imagen10.png" alt="Menú de opciones en abrir ubicación de red">

            <h3>Tarea 2.5</h3>
            <p>Para calcular la compresión que el VLC de emisión está realizando al transcodificar el fichero almacenado a stream comparé la tasa de bits del fichero original con la tasa de bits del stream emitido.</p>
            <p>El fichero clip01 almacenado tiene una tasa de bits de aproximadamente 5120 kbps (5000kbps de video y 128kbps de audio). Durante la emisión la tasa de bits varió entre 2500 kbps y 9000 kbps con una media de aproximadamente 4000 kbps. En la recepción la tasa de bits fue de aproximadamente 1500 kbps.</p>
            <p>Tasa de compresión emisor = Tasa de bits fichero almacenado / Tasa de bits stream emitido = 5120 kbps / 4000 kbps = 1.28:1 &asymp; 1.25:1</p>
            <p>Esto indica que el stream emitido tiene una tasa de compresión de aproximadamente 1.25:1.</p>
            <p>La tasa de bits de recepción es mucho menor y tal y como se indicó en el apartado 2.3 las perdidas repercuten negativamente en la calidad de la visualización. La tasa de compresión del stream recibido respecto al fichero original es de 3.5 a 1:</p>
            <p>Tasa de compresión receptor = Tasa de bits fichero almacenado / Tasa de bits stream recibido = 5120 kbps / 1500 kbps = 3.41:1 &asymp; 3.5:1</p>
            <p>A continuación se muestra una captura de pantalla del escritorio con los dos VLC en marcha y sus ventanas con las estadísticas de cada uno abiertas.</p>
            <img src="images/Imagen11.png" alt="Captura de pantalla con VLC emisor y receptor">

            <h3>Tarea 2.6</h3>
            <p>En esta tarea se abordará la opción de hacer un stream de video en vivo con Live Streaming en AWS con Amazon S3. Para hacerlo además del almacenamiento Amazon S3 se utilizan los servicios Elemental MediaLive [11] y Amazon CloudFront [12]. La descripción que he hecho de los pasos necesarios para configurar y realizar la transmisión en vivo se basan en la guía “Live Streaming on AWS with Amazon S3” [13] que se puede encontrar en la página de AWS.</p>
            <img src="images/Imagen12.png" alt="Diagrama de la arquitectura del streaming">
            <h4>Configuración de AWS Elemental MediaLive</h4>
            <p>El primer paso es utilizar AWS Elemental MediaLive para codificar las transmisiones en tiempo real. MediaLive comprime la transmisión de vídeo en versiones más pequeñas que pueden ser distribuidas a través de CloudFront. Para ello se debe acceder a la consola de AWS Elemental MediaLive y crear un nuevo canal.</p>
            <p>En la configuración del canal es necesario seleccionar un códec de vídeo como H.264 y un códec de audio como AAC. La entrada se puede configurar como una fuente RTMP o HTTP Live Stream (HLS). En este momento se configuran también los perfiles de codificación para asegurar una transmisión fluida y de alta calidad.</p>
            <h4>Configuración de Amazon S3</h4>
            <p>Una vez que MediaLive está configurado es necesario configurar Amazon S3 para almacenar los segmentos codificados del vídeo. Primero se debe crear un bucket en Amazon S3 que servirá como el almacenamiento principal para los segmentos de vídeo. Después se deben configurar las políticas de seguridad y acceso para asegurar que solo los usuarios autorizados puedan acceder al bucket.</p>
            <p>Amazon S3 no solo proporciona almacenamiento escalable y altamente disponible sino que también actúa como el origen de los contenidos de vídeo segmentados. Es posible establecer políticas de acceso detalladas utilizando AWS Identity and Access Management (IAM) para controlar quién puede leer y escribir en el bucket de S3.</p>
            <h4>Configuración de Amazon CloudFront</h4>
            <p>Con Amazon S3 configurado el siguiente paso es crear una distribución de CloudFront. Accedemos a la consola de Amazon CloudFront y creamos una nueva distribución configurándola para utilizar el bucket de Amazon S3 como origen. CloudFront se encargará de distribuir el contenido de vídeo a los espectadores con baja latencia y alta velocidad de transferencia.</p>
            <p>Durante la configuración también es recomendable implementar una identidad de acceso al origen (OAI) para restringir el acceso directo a los contenidos en S3. Esto mejora la seguridad al asegurar que solo CloudFront pueda acceder directamente a los archivos en el bucket de S3. Adicionalmente se deben configurar las políticas de caché y seguridad para optimizar la entrega del contenido.</p>
            <h4>Políticas de seguridad y gestión de usuarios</h4>
            <p>La implementación de políticas de seguridad específicas es importante para garantizar la integridad y disponibilidad del servicio. AWS Identity and Access Management (IAM) se utiliza para definir roles y políticas que controlan el acceso a los diferentes servicios de AWS. Se pueden crear roles de IAM con permisos específicos para los distintos servicios que interactúan con la transmisión en vivo como MediaLive, S3 y CloudFront.</p>
            <h4>Cálculo estimado del coste</h4>
            <p>Para estimar el coste por minuto de una transmisión HD me baso en la información proporcionada en el ejemplo número 2 [14] de la guía de implementación de AWS Live Streaming en su apartado de costes. Los precios están en dólares y se han calculado para la región US-East-1 en Estados Unidos. En la guía no se especifica si se aplican diferentes tarificaciones para las distintas regiones pero puede dar una idea aproximada de lo que costaría el servicio en Europa. Se considera una transmisión en vivo de contenido HD (1080p 30fps) para 10000 usuarios simultaneos.</p>
            <p>El coste de la transcodificación y empaquetado para contenido en alta definición (1080p 30 fps) es de aproximadamente $3.11 por hora.</p>
            <img src="images/Imagen13.png" alt="Coste MediaLive por hora">
            <p>Las tarifas de Amazon S3 incluyen 0023 dólares por gigabyte (GB) al mes almacenado para los primeros 50 TB. Además se cobran $0.005 por cada 1000 solicitudes PUT COPY POST o LIST. Para este caso con 6 outputs en distintas resoluciones y 21 segmentos de 4s almacenados. Se tiene un coste de almacenamiento por hora de $0.000005 y de $0.054 para las peticiones.</p>
            <img src="images/Imagen14.png" alt="Coste Amazon S3 por hora">
            <p>Si asumimos un ancho de banda promedio de 4.1Mbps por espectador y considerando una tarifa de $0.085 por GB distribuido el coste total de distribución será de $1531.49 por hora.</p>
            <img src="images/Imagen15.png" alt="Coste de distribución por hora">
            <p>Por tanto el coste total del servicio es de 1534.65 dólares por hora o 25.58 dólares por minuto:</p>
            <p>$3.11/h + $0.054/h + $1531.49/h = $1534.65/h = $25.58/min</p>
        </section>

        <section>
            <h2>Bibliografía</h2>
            <ul>
                <li>[1] Wikipedia «Advanced Video Coding» Wikipedia. https://en.wikipedia.org/wiki/Advanced_Video_Coding (accedido abr. 14 2024).</li>
                <li>[2] Wikipedia «VP9». https://en.wikipedia.org/wiki/VP9 (accedido may 19 2024).</li>
                <li>[3] IBM «Recommended Encoding Settings». https://support.video.ibm.com/hc/en-us/articles/207852117-Internet-connection-and-recommended-encoding-settings (accedido may 19 2024).</li>
                <li>[4] V. Shah «Why you should choose HTML5?» 2022. https://www.aceinfoway.com/blog/html5-benefits-and-features (accedido may 19 2024).</li>
                <li>[5] Wikipedia «HTML5» 2024. https://en.wikipedia.org/wiki/HTML5 (accedido may 19 2024).</li>
                <li>[6] GitHub «GitHub». https://github.com/ (accedido may 19 2024).</li>
                <li>[7] AWS «Amazon Transcribe Documentation». https://docs.aws.amazon.com/transcribe/ (accedido may 23 2024).</li>
                <li>[8] AWS «Amazon Rekognition Documentation». https://docs.aws.amazon.com/rekognition/ (accedido may 23 2024).</li>
                <li>[9] AWS «AWS Elemental MediaPackage Documentation». https://docs.aws.amazon.com/mediapackage/.</li>
                <li>[10] AWS «Amazon Translate». https://aws.amazon.com/es/translate/ (accedido may 23 2024).</li>
                <li>[11] AWS «AWS Elemental MediaLive» 2024. https://aws.amazon.com/es/medialive/features/ (accedido abr. 16 2024).</li>
                <li>[12] AWS «Amazon CloudFront». https://aws.amazon.com/es/cloudfront/?nc2=h_ql_sol_use_cd (accedido abr. 16 2024).</li>
                <li>[13] AWS «Live Streaming on AWS with Amazon S3». https://docs.aws.amazon.com/solutions/latest/live-streaming-on-aws-with-amazon-s3/solution-overview.html (accedido may 28 2024).</li>
                <li>[14] AWS «Ejemplo costes 2 - Live Straming on AWS with Amazon S3». https://docs.aws.amazon.com/solutions/latest/live-streaming-on-aws-with-amazon-s3/cost-example-2.html (accedido may 29 2024).</li>
            </ul>
        </section>
    </main>
    <footer>
        <p>&copy; 2024 Carlos Manuel Ruiz Ruiz</p>
    </footer>
</body>
</html>
